"use strict";

(async function () {
  try {
    var dataApi = await fetch("https://api.punkapi.com/v2/beers");
    var beers = await dataApi.json();
    var $beerList = document.querySelector(".beer-list");
    // console.log(beers);

    var data = [];
    beers.map(function (v) {
      var yearArr = v.first_brewed.split("/");
      var dataObj = {};
      dataObj.name = v.name;
      dataObj.image_url = v.image_url;
      dataObj.id = v.id;
      dataObj.year = yearArr[1];
      dataObj.tagline = v.tagline;
      data.push(dataObj);
    });

    var template = document.querySelector("#beers-template").textContent;
    var render = Handlebars.compile(template);
    var html = render(data);
    $beerList.innerHTML = html;
    document.querySelector("#preloader").style.display = "none";
    clickHandler();
  } catch (e) {
    console.error(e);
  }
})();

function clickHandler() {
  document.querySelector(".beer-list").addEventListener("click", function (e) {
    e.preventDefault();
    var currentId = void 0;
    currentId = e.target.dataset.id ? e.target.dataset.id : e.target.parentNode.dataset.id;
    getBeer(currentId);
  });
  async function getBeer(currentId) {
    try {
      document.querySelector("#preloader").style.position = "fixed";
      document.querySelector("#preloader").style.display = "initial";
      var dataApi = await fetch("https://api.punkapi.com/v2/beers/" + currentId);
      var beerData = await dataApi.json();
      var $beerDialog = document.querySelector("#beer-dialog");

      var beer = {};
      beer.id = beerData[0].id;
      beer.name = beerData[0].name;
      beer.image_url = beerData[0].image_url;
      beer.first_brewed = beerData[0].first_brewed;
      beer.tagline = beerData[0].tagline;
      beer.description = beerData[0].description;
      beer.boil_volume = beerData[0].boil_volume;
      beer.food_pairing = beerData[0].food_pairing;

      var template = document.querySelector("#beer-template").textContent;
      var render = Handlebars.compile(template);
      var html = render(beer);
      $beerDialog.innerHTML = html;
      document.querySelector("#preloader").style.display = "none";
      $beerDialog.style.display = "block";
    } catch (e) {
      console.error(e);
    }
  }
}
"use strict";

jQuery(function ($) {
  $(".beer").on("click", ".beer-dialog__close", function () {
    $("#beer-dialog").fadeOut();
  });
});
"use strict";

function searchName() {
  var input, filter, ul, li, a, i;
  input = document.querySelector(".search");
  filter = input.value.toUpperCase();
  ul = document.querySelector(".beer-list");
  li = document.querySelectorAll(".beer-item");
  var newss = Array.from(li);
  a = li[0].dataset.name;
  for (i = 0; i < li.length; i++) {
    a = li[i].dataset.name;
    if (a.toUpperCase().indexOf(filter) > -1) {
      li[i].style.display = "";
    } else {
      li[i].style.display = "none";
    }
  }
}

document.querySelector(".search").addEventListener("keyup", searchName);
"use strict";

jQuery(function ($) {
  var $beerList = $(".beer-list");
  var $sortId = $(".sort__link-id");
  var $sortName = $(".sort__link-name");
  var $sortYear = $(".sort__link-year");
  var beerItem = ".beer-item";

  $sortId.on("click", function (e) {
    if (e.target.dataset.order === "asc") {
      $beerList.find(".beer-item").sort(function (a, b) {
        return +a.dataset.id - +b.dataset.id;
      }).appendTo($beerList);
    } else {
      $beerList.find(".beer-item").sort(function (a, b) {
        return +b.dataset.id - +a.dataset.id;
      }).appendTo($beerList);
    }
    e.target.dataset.order = e.target.dataset.order === "asc" ? "desc" : "asc";
  });

  $sortYear.on("click", function (e) {
    if (e.target.dataset.order === "asc") {
      $beerList.find(beerItem).sort(function (a, b) {
        return +a.dataset.year - +b.dataset.year;
      }).appendTo($beerList);
    } else {
      $beerList.find(beerItem).sort(function (a, b) {
        return +b.dataset.year - +a.dataset.year;
      }).appendTo($beerList);
    }
    e.target.dataset.order = e.target.dataset.order === "asc" ? "desc" : "asc";
  });

  $sortName.on("click", function (e) {
    if (e.target.dataset.order === "asc") {
      $beerList.find(beerItem).sort(function (a, b) {
        if (a.dataset.name < b.dataset.name) return -1;
        if (a.dataset.name > b.dataset.name) return 1;
        return 0;
      }).appendTo($beerList);
    } else {
      $beerList.find(beerItem).sort(function (a, b) {
        if (b.dataset.name < a.dataset.name) return -1;
        if (b.dataset.name > a.dataset.name) return 1;
        return 0;
      }).appendTo($beerList);
    }
    e.target.dataset.order = e.target.dataset.order === "asc" ? "desc" : "asc";
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFqYXguanMiLCJjb21tb24uanMiLCJzZWFyY2guanMiLCJzb3J0LmpzIl0sIm5hbWVzIjpbImRhdGFBcGkiLCJmZXRjaCIsImJlZXJzIiwianNvbiIsIiRiZWVyTGlzdCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImRhdGEiLCJtYXAiLCJ5ZWFyQXJyIiwidiIsImZpcnN0X2JyZXdlZCIsInNwbGl0IiwiZGF0YU9iaiIsIm5hbWUiLCJpbWFnZV91cmwiLCJpZCIsInllYXIiLCJ0YWdsaW5lIiwicHVzaCIsInRlbXBsYXRlIiwidGV4dENvbnRlbnQiLCJyZW5kZXIiLCJIYW5kbGViYXJzIiwiY29tcGlsZSIsImh0bWwiLCJpbm5lckhUTUwiLCJzdHlsZSIsImRpc3BsYXkiLCJjbGlja0hhbmRsZXIiLCJlIiwiY29uc29sZSIsImVycm9yIiwiYWRkRXZlbnRMaXN0ZW5lciIsInByZXZlbnREZWZhdWx0IiwiY3VycmVudElkIiwidGFyZ2V0IiwiZGF0YXNldCIsInBhcmVudE5vZGUiLCJnZXRCZWVyIiwicG9zaXRpb24iLCJiZWVyRGF0YSIsIiRiZWVyRGlhbG9nIiwiYmVlciIsImRlc2NyaXB0aW9uIiwiYm9pbF92b2x1bWUiLCJmb29kX3BhaXJpbmciLCJqUXVlcnkiLCIkIiwib24iLCJmYWRlT3V0Iiwic2VhcmNoTmFtZSIsImlucHV0IiwiZmlsdGVyIiwidWwiLCJsaSIsImEiLCJpIiwidmFsdWUiLCJ0b1VwcGVyQ2FzZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJuZXdzcyIsIkFycmF5IiwiZnJvbSIsImxlbmd0aCIsImluZGV4T2YiLCIkc29ydElkIiwiJHNvcnROYW1lIiwiJHNvcnRZZWFyIiwiYmVlckl0ZW0iLCJvcmRlciIsImZpbmQiLCJzb3J0IiwiYiIsImFwcGVuZFRvIl0sIm1hcHBpbmdzIjoiOztBQUFBLENBQUMsa0JBQVk7QUFDWCxNQUFJO0FBQ0YsUUFBSUEsVUFBVSxNQUFNQyxNQUFNLGtDQUFOLENBQXBCO0FBQ0EsUUFBSUMsUUFB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LENBbkVEIiwiZmlsZSI6ImFsbC5qcyIsInNvdXJjZXNDb250ZW50IjpbIihhc3luYyAoKSA9PiB7XG4gIHRyeSB7XG4gICAgbGV0IGRhdGFBcGkgPSBhd2FpdCBmZXRjaChcImh0dHBzOi8vYXBpLnB1bmthcGkuY29tL3YyL2JlZXJzXCIpO1xuICAgIGxldCBiZWVycyA9IGF3YWl0IGRhdGFBcGkuanNvbigpO1xuICAgIGxldCAkYmVlckxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmJlZXItbGlzdFwiKTtcbiAgICAvLyBjb25zb2xlLmxvZyhiZWVycyk7XG5cbiAgICBsZXQgZGF0YSA9IFtdO1xuICAgIGJlZXJzLm1hcCh2ID0+IHtcbiAgICAgIGxldCB5ZWFyQXJyID0gdi5maXJzdF9icmV3ZWQuc3BsaXQoXCIvXCIpO1xuICAgICAgbGV0IGRhdGFPYmogPSB7fTtcbiAgICAgIGRhdGFPYmoubmFtZSA9IHYubmFtZTtcbiAgICAgIGRhdGFPYmouaW1hZ2VfdXJsID0gdi5pbWFnZV91cmw7XG4gICAgICBkYXRhT2JqLmlkID0gdi5pZDtcbiAgICAgIGRhdGFPYmoueWVhciA9IHllYXJBcnJbMV07XG4gICAgICBkYXRhT2JqLnRhZ2xpbmUgPSB2LnRhZ2xpbmU7XG4gICAgICBkYXRhLnB1c2goZGF0YU9iaik7XG4gICAgfSk7XG5cbiAgICBjb25zdCB0ZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYmVlcnMtdGVtcGxhdGVcIikudGV4dENvbnRlbnQ7XG4gICAgY29uc3QgcmVuZGVyID0gSGFuZGxlYmFycy5jb21waWxlKHRlbXBsYXRlKTtcbiAgICBjb25zdCBodG1sID0gcmVuZGVyKGRhdGEpO1xuICAgICRiZWVyTGlzdC5pbm5lckhUTUwgPSBodG1sO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJlbG9hZGVyXCIpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICBjbGlja0hhbmRsZXIoKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvbnNvbGUuZXJyb3IoZSk7XG4gIH1cbn0pKCk7XG5cbmZ1bmN0aW9uIGNsaWNrSGFuZGxlcigpIHtcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5iZWVyLWxpc3RcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgbGV0IGN1cnJlbnRJZDtcbiAgICBjdXJyZW50SWQgPSBlLnRhcmdldC5kYXRhc2V0LmlkXG4gICAgICA/IGUudGFyZ2V0LmRhdGFzZXQuaWRcbiAgICAgIDogZS50YXJnZXQucGFyZW50Tm9kZS5kYXRhc2V0LmlkO1xuICAgIGdldEJlZXIoY3VycmVudElkKTtcbiAgfSk7XG4gIGFzeW5jIGZ1bmN0aW9uIGdldEJlZXIoY3VycmVudElkKSB7XG4gICAgdHJ5IHtcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJlbG9hZGVyXCIpLnN0eWxlLnBvc2l0aW9uID0gXCJmaXhlZFwiO1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmVsb2FkZXJcIikuc3R5bGUuZGlzcGxheSA9IFwiaW5pdGlhbFwiO1xuICAgICAgbGV0IGRhdGFBcGkgPSBhd2FpdCBmZXRjaChcbiAgICAgICAgYGh0dHBzOi8vYXBpLnB1bmthcGkuY29tL3YyL2JlZXJzLyR7Y3VycmVudElkfWBcbiAgICAgICk7XG4gICAgICBsZXQgYmVlckRhdGEgPSBhd2FpdCBkYXRhQXBpLmpzb24oKTtcbiAgICAgIGxldCAkYmVlckRpYWxvZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYmVlci1kaWFsb2dcIik7XG5cbiAgICAgIGxldCBiZWVyID0ge307XG4gICAgICBiZWVyLmlkID0gYmVlckRhdGFbMF0uaWQ7XG4gICAgICBiZWVyLm5hbWUgPSBiZWVyRGF0YVswXS5uYW1lO1xuICAgICAgYmVlci5pbWFnZV91cmwgPSBiZWVyRGF0YVswXS5pbWFnZV91cmw7XG4gICAgICBiZWVyLmZpcnN0X2JyZXdlZCA9IGJlZXJEYXRhWzBdLmZpcnN0X2JyZXdlZDtcbiAgICAgIGJlZXIudGFnbGluZSA9IGJlZXJEYXRhWzBdLnRhZ2xpbmU7XG4gICAgICBiZWVyLmRlc2NyaXB0aW9uID0gYmVlckRhdGFbMF0uZGVzY3JpcHRpb247XG4gICAgICBiZWVyLmJvaWxfdm9sdW1lID0gYmVlckRhdGFbMF0uYm9pbF92b2x1bWU7XG4gICAgICBiZWVyLmZvb2RfcGFpcmluZyA9IGJlZXJEYXRhWzBdLmZvb2RfcGFpcmluZztcblxuICAgICAgY29uc3QgdGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2JlZXItdGVtcGxhdGVcIikudGV4dENvbnRlbnQ7XG4gICAgICBjb25zdCByZW5kZXIgPSBIYW5kbGViYXJzLmNvbXBpbGUodGVtcGxhdGUpO1xuICAgICAgY29uc3QgaHRtbCA9IHJlbmRlcihiZWVyKTtcbiAgICAgICRiZWVyRGlhbG9nLmlubmVySFRNTCA9IGh0bWw7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZWxvYWRlclwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAkYmVlckRpYWxvZy5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XG4gICAgfVxuICB9XG59XG4iLCJqUXVlcnkoZnVuY3Rpb24oJCkge1xuICAkKFwiLmJlZXJcIikub24oXCJjbGlja1wiLCBcIi5iZWVyLWRpYWxvZ19fY2xvc2VcIiwgZnVuY3Rpb24oKSB7XG4gICAgJChcIiNiZWVyLWRpYWxvZ1wiKS5mYWRlT3V0KCk7XG4gIH0pO1xufSk7XG4iLCJmdW5jdGlvbiBzZWFyY2hOYW1lKCkge1xuICB2YXIgaW5wdXQsIGZpbHRlciwgdWwsIGxpLCBhLCBpO1xuICBpbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2VhcmNoXCIpO1xuICBmaWx0ZXIgPSBpbnB1dC52YWx1ZS50b1VwcGVyQ2FzZSgpO1xuICB1bCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYmVlci1saXN0XCIpO1xuICBsaSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYmVlci1pdGVtXCIpO1xuICBsZXQgbmV3c3MgPSBBcnJheS5mcm9tKGxpKTtcbiAgYSA9IGxpWzBdLmRhdGFzZXQubmFtZTtcbiAgZm9yIChpID0gMDsgaSA8IGxpLmxlbmd0aDsgaSsrKSB7XG4gICAgYSA9IGxpW2ldLmRhdGFzZXQubmFtZTtcbiAgICBpZiAoYS50b1VwcGVyQ2FzZSgpLmluZGV4T2YoZmlsdGVyKSA+IC0xKSB7XG4gICAgICBsaVtpXS5zdHlsZS5kaXNwbGF5ID0gXCJcIjtcbiAgICB9IGVsc2Uge1xuICAgICAgbGlbaV0uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgIH1cbiAgfVxufVxuXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNlYXJjaFwiKS5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgc2VhcmNoTmFtZSk7XG4iLCJqUXVlcnkoZnVuY3Rpb24oJCkge1xuICBsZXQgJGJlZXJMaXN0ID0gJChcIi5iZWVyLWxpc3RcIik7XG4gIGxldCAkc29ydElkID0gJChcIi5zb3J0X19saW5rLWlkXCIpO1xuICBsZXQgJHNvcnROYW1lID0gJChcIi5zb3J0X19saW5rLW5hbWVcIik7XG4gIGxldCAkc29ydFllYXIgPSAkKFwiLnNvcnRfX2xpbmsteWVhclwiKTtcbiAgbGV0IGJlZXJJdGVtID0gXCIuYmVlci1pdGVtXCI7XG5cbiAgJHNvcnRJZC5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKGUpIHtcbiAgICBpZiAoZS50YXJnZXQuZGF0YXNldC5vcmRlciA9PT0gXCJhc2NcIikge1xuICAgICAgJGJlZXJMaXN0XG4gICAgICAgIC5maW5kKFwiLmJlZXItaXRlbVwiKVxuICAgICAgICAuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICAgIHJldHVybiArYS5kYXRhc2V0LmlkIC0gK2IuZGF0YXNldC5pZDtcbiAgICAgICAgfSlcbiAgICAgICAgLmFwcGVuZFRvKCRiZWVyTGlzdCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICRiZWVyTGlzdFxuICAgICAgICAuZmluZChcIi5iZWVyLWl0ZW1cIilcbiAgICAgICAgLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgICByZXR1cm4gK2IuZGF0YXNldC5pZCAtICthLmRhdGFzZXQuaWQ7XG4gICAgICAgIH0pXG4gICAgICAgIC5hcHBlbmRUbygkYmVlckxpc3QpO1xuICAgIH1cbiAgICBlLnRhcmdldC5kYXRhc2V0Lm9yZGVyID0gZS50YXJnZXQuZGF0YXNldC5vcmRlciA9PT0gXCJhc2NcIiA/IFwiZGVzY1wiIDogXCJhc2NcIjtcbiAgfSk7XG5cbiAgJHNvcnRZZWFyLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24oZSkge1xuICAgIGlmIChlLnRhcmdldC5kYXRhc2V0Lm9yZGVyID09PSBcImFzY1wiKSB7XG4gICAgICAkYmVlckxpc3RcbiAgICAgICAgLmZpbmQoYmVlckl0ZW0pXG4gICAgICAgIC5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgICAgcmV0dXJuICthLmRhdGFzZXQueWVhciAtICtiLmRhdGFzZXQueWVhcjtcbiAgICAgICAgfSlcbiAgICAgICAgLmFwcGVuZFRvKCRiZWVyTGlzdCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICRiZWVyTGlzdFxuICAgICAgICAuZmluZChiZWVySXRlbSlcbiAgICAgICAgLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgICByZXR1cm4gK2IuZGF0YXNldC55ZWFyIC0gK2EuZGF0YXNldC55ZWFyO1xuICAgICAgICB9KVxuICAgICAgICAuYXBwZW5kVG8oJGJlZXJMaXN0KTtcbiAgICB9XG4gICAgZS50YXJnZXQuZGF0YXNldC5vcmRlciA9IGUudGFyZ2V0LmRhdGFzZXQub3JkZXIgPT09IFwiYXNjXCIgPyBcImRlc2NcIiA6IFwiYXNjXCI7XG4gIH0pO1xuXG4gICRzb3J0TmFtZS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKGUpIHtcbiAgICBpZiAoZS50YXJnZXQuZGF0YXNldC5vcmRlciA9PT0gXCJhc2NcIikge1xuICAgICAgJGJlZXJMaXN0XG4gICAgICAgIC5maW5kKGJlZXJJdGVtKVxuICAgICAgICAuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICAgIGlmIChhLmRhdGFzZXQubmFtZSA8IGIuZGF0YXNldC5uYW1lKSByZXR1cm4gLTE7XG4gICAgICAgICAgaWYgKGEuZGF0YXNldC5uYW1lID4gYi5kYXRhc2V0Lm5hbWUpIHJldHVybiAxO1xuICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9KVxuICAgICAgICAuYXBwZW5kVG8oJGJlZXJMaXN0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgJGJlZXJMaXN0XG4gICAgICAgIC5maW5kKGJlZXJJdGVtKVxuICAgICAgICAuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICAgIGlmIChiLmRhdGFzZXQubmFtZSA8IGEuZGF0YXNldC5uYW1lKSByZXR1cm4gLTE7XG4gICAgICAgICAgaWYgKGIuZGF0YXNldC5uYW1lID4gYS5kYXRhc2V0Lm5hbWUpIHJldHVybiAxO1xuICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9KVxuICAgICAgICAuYXBwZW5kVG8oJGJlZXJMaXN0KTtcbiAgICB9XG4gICAgZS50YXJnZXQuZGF0YXNldC5vcmRlciA9IGUudGFyZ2V0LmRhdGFzZXQub3JkZXIgPT09IFwiYXNjXCIgPyBcImRlc2NcIiA6IFwiYXNjXCI7XG4gIH0pO1xufSk7XG4iXX0=
